(this.$WP=this.$WP||[]).push(["5miaKe",(e,t)=>{"use strict";var s,i,r,o,a,n,c,l,d,p,u,m,v,_,g,b,k,f,S,I,h,y,P,N,R,T,j=(e,t)=>{var s=t in I,[{data:i,fetching:r,error:o}]=h({query:P,variables:{socialObjects:[{objectId:String(e),objectType:S[t]}]},executeWhen:s?"afterInvalidation":"never"},{createRepost:s=>String(s.refId)===String(e)&&s.refType===S[t]?"invalidateAndRefetch":"validate"});return!r&&!o&&i&&i.socialStatistics&&i.socialStatistics.length&&i.socialStatistics[0]||null},O=e=>{if(e&&e.blockStatus){var{blockStatus:t}=e;if(t&&(t.isBlocking||t.isBlockingYou))return!1}return!0},w=e=>{var t,s,a,{current:m}=r("RepostUploader:"+Math.random()),{feedSectionItem:k}=e.repostPreviewProps,f=(null==(t=e.originalRepostReference)?void 0:t.id)||k.object.id||k.object.mediaBatchId||k.object.postId,S=(null==(s=e.originalRepostReference)?void 0:s.type)||k.object.__typename,I=j(f,S),h=I?I.isReposted:e.socialStatistics&&e.socialStatistics.isReposted,{styleAsShareListItem:P,openRepostModalAsLocal:T}=e,w=r(void 0),C=(e,t,s)=>{w.current&&w.current(e,t,s)},L=()=>!(!O(e.actor)||e.repostPreviewProps&&!O(e.repostPreviewProps.actor))||("function"==typeof w.current&&w.current(S,"no_permission"),!1),{loggedInUserId:U}=e,D=function(e,t){if(null==e)return{};var s,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)s=o[i],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,["loggedInUserId"]);if(!e.repostPreviewProps.member&&U){var M=[{id:e.loggedInUserId}];a=i(n,{query:v,variables:{userIds:M}},({data:t})=>{var{memberProfiles:s=null}=t||{},r=s?s[0]:null,o=Object.assign({},e.repostPreviewProps);return o.member=r,D.repostPreviewProps=o,i(R,Object.assign({},D,{modalName:m,repostCallback:C}))})}else a=i(R,Object.assign({},D,{modalName:m,repostCallback:C}));var F=i(o,null,i(_,{pid:40434},t=>i(u,{name:m,local:T},s=>i(b,null,r=>i("span",{onClick:i=>{h||(N(),e.onClick&&e.onClick(),p.isNativeWebview()?f&&S&&p.postToBridge("repost",1,{objectId:f,type:S}):(r(i,"repost"),t().then(L).then(e=>{e&&s()})))},className:c(P?"_3mWM5uYS":"_1rKgQ-lu",{R_qkVKfx:h})},i(g,{name:"repost",className:"_18rdDspH"}),i("span",{className:"ui_link _6C_PDrxI socialCTA"},d(h?"reposted":P?"social_repost_on_tripadvisor":"social_repost")))))),a,i(y,null,e=>{w.current=e}));return i(o,null,l("social_reposts")?F:null)},C={};return[()=>{y=class extends s{constructor(...e){super(...e),this.successToastMessage={Review:d("success_repost_review"),Photo:d("success_repost_photo"),Video:d("success_repost_video"),ForumPost:d("success_repost_forum"),LinkPost:d("success_repost_link"),Trip:d("success_repost_trip"),MediaBatch:d("success_repost_photos")}}createToast(e,t,s){switch(t){case"success":return{node:this.successToastMessage[e],cta:i(k,{href:s?"/Profile/"+s:"/Profile",to:{page:"Profile",username:s}},d("view_repost"))};case"error":return{node:d("repost_failure_message")};case"rate_limited":return{node:d("repost_rate_limited_v2")};case"no_permission":return{node:d("social_no_permission")};default:return{node:""}}}render(){return i(f,null,e=>this.props.children((t,s,i)=>{e(this.createToast(t,s,i))}))}},(P=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"RepostStatsQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}},"type":{"kind":"NonNullType","type":{"kind":"ListType","type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"SocialObjectInternalInput"}}}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"socialStatistics"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"objects"},"value":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"isReposted"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"repostCount"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":163}}')).__key=9396123310041,P.loc.source={body:"088bb49797d9"},[N,R]=m.onTrigger(()=>t("fmDsJ-"),"RepostUploader"),T=a(e=>({loggedInUserId:e.auth.loggedInUserId}))(w),e("default",C),e({RepostAction:T,useUpdatedRepostStats:j})},[e=>(s=e.Component,i=e.createElement,r=e.useRef,o=e.Fragment),e=>a=e.connect,e=>n=e.Query,e=>c=e.default,e=>l=e.featureIsEnabled,e=>d=e.localize,e=>p=e.NativeBridge,e=>u=e.Opener,e=>m=e.component,e=>v=e.ProfileQueryWithUserId,e=>_=e.SocialLoginGate,e=>g=e.Icon,e=>b=e.InteractionLogger,e=>k=e.Link,e=>f=e.Toaster,e=>(S=e.SocialObjectTypeMap,I=e.RepostedObjectTypeMap),e=>h=e.useInvalidatableQuery]]},["cDcdfi","h74DsO","5X2em-","jSLlaY","-i3PJS","535agn","Ov85iR","pT-O8u","pLbCP4","8vFdtI","JFHNGL","_qQcW3","pZzSdK","N4pTU2","t1LGYH","CXMmrT","OnmvvE"]]);
